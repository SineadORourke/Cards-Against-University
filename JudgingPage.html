<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    

    <title>Judging</title>
	<link rel="stylesheet" href="cauStyle.css">
	
	<!-- Firebase Library -->
	<script src='https://cdn.firebase.com/js/client/2.4.1/firebase.js'></script>

	<!--Disable Back Button -->
    <script type="text/javascript">
        window.history.forward();
        function noBack()
        {
            window.history.forward();
        }
    </script>

	<!--Links for Bootstrap-->
    <meta charset="utf-8"> 
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
	<link rel="stylesheet" href="cauStyle.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
	<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  
	</head>
	
	
	
	
<body data-spy="scroll" data-target=".navbar" data-offset="50" id="main" onLoad="noBack();" onpageshow="if (event.persisted) noBack();" onUnload="">
	
	<!-- Navigation Bar
    ================================================== -->
	<nav class="navbar navbar-inverse" data-spy="affix" data-offset-top="197" id="navigationColour">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>                        
				</button>
				<img src="defaultlogo.png" alt="logo" id="Logo">
				<p class="navbar-brand">Cards Against University : Judging Panel</p>
			</div>
    
			<div>
				<div class="collapse navbar-collapse" id="myNavbar">
					<!-- Navigation options centered 				Can center "Judging Panel"
					<ul class="nav navbar-nav">
						<li><a href="#">Judging Panel</a></li>
					</ul>-->
					
					<!-- Navigation option to the right -->
					<ul class="nav navbar-nav navbar-right">
						<li><a href="#">Quit</a></li>
						<li class="dropdown navbar-right" id="profile"><a class="dropdown-toggle" data-toggle="dropdown" href="#">Profile <span class="caret"></span></a>
							<ul class="dropdown-menu">
								<li><a href="#">Current credits</a></li>
								<li><a href="#">Coin counter</a></li>
							</ul>
						</li>
					</ul>
				</div>
			</div>
		</div>
	</nav><!-- ./navigation Bar -->    
	
	
	<!-- HTML for Black Scenario card -->

    <center>
        <div class="blackscenario">
          <div id="blackimage">
            <img src="blackscenariocard.jpeg" alt="Black Scenario Card Goes Here" id="black" width="250" height="300">
          </div>
          <div id="blackCardHeader">
            <h3 class="scenarioCardText" id ="blackCardText"><h3>
          </div>
        </div>
      </center>
	
	

    <!-- Block buttons 
    =======================================================-->
    <div class="container">
    

      <h2>Pick the Winner!</h2>
      <button type="button" class="btn btn-primary btn-lg btn-block"  onclick="voteOpt1()"><label id="s1" for="subOpt1"></label></button>
      <button type="button" class="btn btn-default btn-lg btn-block"  onclick="voteOpt2"><label id="s2" for="subOpt2"></button>
      <button type="button" class="btn btn-primary btn-lg btn-block"  onclick="voteOpt3()"><label id="s3" for="subOpt3"></button>
      <button type="button" class="btn btn-default btn-lg btn-block"  onclick="voteOpt4()"><label id="s4" for="subOpt4"></button>
      <button type="button" class="btn btn-default btn-lg btn-block"  onclick="voteOpt5()"><label id="s5" for="subOpt5"></button>

      
    </div>




	
	<!-- modal code 
		===============================  -->
		
	<div id="myModal" class="modal fade" role="dialog" data-keyboard="false" data-backdrop="static">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
       <div id = "timer2"></div>
        <h4 class="modal-title">Your vote has been submitted</h4>
      </div>
      <div class="modal-body">
        <p>Waiting for other players to submit their vote</p>
      </div>
      
    </div>

  </div>
</div>

	
	

 
    <script>
    
    var timeLeft = 130;
    
    var elem2 = document.getElementById('timer2');
    var timerId = setInterval(countdown, 1000);
    function countdown() {
      if (timeLeft == 0) {
        clearTimeout(timerId);
        //alert("Times up!")
        alert("You ran out of time");
        location.href="resultpage.html"
        
        //document.getElementById("submit1").disabled = true;
        
      } else {
        
        elem2.innerHTML = timeLeft + ' seconds remaining';
        timeLeft--;
      }
    }

    //Javascript for voting submission -->

    var GameRef = localStorage.getItem("GameRef"); //get the game reference from previous page to pull data down from database
    var counter = 0; 

    var ref = new Firebase("https://cau-maynooth.firebaseio.com/Game/" + GameRef); // Store a link to location of current game
    ref.on("value", function(snapshot) {
            snapshot.forEach(function(data) { // Loop through each submitted answerand display on buttons for user choice
                document.getElementsByTagName('button')[counter].textContent = data.val(); 
                counter++; // increment counter to display snapshot data on next button
                
            });
    });

                /*setTimeout(function () { // 1 second delay to allow for firebase callback
                    console.log("Next loop");
                }, 1000);*/
                //var getEle;
                //var count = 1;
                //getEle = "s";
                //getEle = getEle + count;
                //console.log("Counter val was " + count);
                //console.log("Element id = " + getEle);
                //count++;
                //console.log("Counter val is now " + count);



    // OLD CODE BEFORE DYNAMICALLY REAL TIME DATA EXTRAPOLATED FROM DATABASE
    /*ref.on("value", function(snapshot) {
        sub = snapshot.child("GameRef");
        one = sub.val();
        document.getElementById("s1").textContent = one;
        //one = sub;
    }, function (errorObject) {
            console.log("The read failed: " + errorObject.code);
    });

    // the main firebase reference.
    var myDataRef = new Firebase('https://cau-maynooth.firebaseio.com');
    
    var form = document.getElementById("myForm"); // use the form so we can access the submit  buttons.

    var subVoteText = form.elements["subOpt"];  // store the submit buttons into an array.

      // store the text value associated with the submit buttons into a variable.
    
    var two = subVoteText[1].nextSibling.data;
    var three = subVoteText[2].nextSibling.data;
    var four = subVoteText[3].nextSibling.data;*/

 	

    
    var usersRef = myDataRef.child("Judging"); // save the data into a new branch called judging.

    function voteOpt1() {

        var one = document.getElementById('s1').textContent;

        if (confirm("Is the following your choice: " + one + "?") == true) {
            window.location.href="resultpage.html";
            usersRef.child("votes").set({
                vote : one
            });
            
        } else {
            alert("Pick a different option");
        }
    }

    function voteOpt2() {

        var two = document.getElementById('s2').textContent;


        if (confirm("Is this your choice: " + sTwo + "?") == true) {
            window.location.href="resultpage.html";
            usersRef.child("votes").set({
                vote : two
            });
            
        } else {
            alert("Pick a different option");
        }
    }

    function voteOpt3() {

        var three = document.getElementById('s3').textContent;


        if (confirm("Are you sure you want to pick the option below?" + sThree) == true) {
             window.location.href="resultpage.html";
            usersRef.child("votes").set({
                vote : three
            });
           
        } else {
            alert("Pick a different option");
        }
    }

    function voteOpt4() {

        var four = document.getElementById('s4').textContent;

        if (confirm("Are you sure you want to pick the option below?" + sFour) == true) {
             window.location.href="resultpage.html";
            usersRef.child("votes").set({
                vote : four
            });
           
        } else {
            alert("Pick a different option");
        }
    }

    function voteOpt5() {

        var five = document.getElementById('s5').textContent;

        if (confirm("Are you sure you want to pick the option below?" + sFour) == true) {
             window.location.href="resultpage.html";
            usersRef.child("votes").set({
                vote : five
            });
           
        } else {
            alert("Pick a different option");
        }
    }
    


    </script>
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')</script>
    <script src="../../dist/js/bootstrap.min.js"></script>
    <script src="../../assets/js/vendor/holder.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../../assets/js/ie10-viewport-bug-workaround.js"></script>
        
  </body>
</html>
